library (ggplot2)
library (dplyr)
library (ddplyr)
library(dplyr)
source("https://bioconductor.org/biocLite.R")
biocLite()
library(dplyr)
bioclite()
library(plyr)
load("~/Dropbox/Migration routes/Figures/Figure 3/Data/R heatmap codes/2016-03-23-allenbrain_compare/.RData")
load("~/Dropbox/Migration routes/Figures/Figure 3/Data/R heatmap codes/2016-03-23-allenbrain_compare/2016-03-20_env.RData")
load("~/Dropbox/Migration routes/Figures/Figure 3/Data/R heatmap codes/2016-03-23-allenbrain_compare/2016-03-20_env.RData")
setwd("~/Dropbox/Fishou/Marinlabwork/papers_writing/migration route revision data/MafB Ephys/Analysis_sCRACM/2017_R_ephys")
library (plotrix) #use for std.error
library (ggplot2) #use for ggplot
library (plyr) #use for ddply
Het <- read.csv('Het15psCRACM_avg.csv', header = TRUE)
HO <- read.csv('HO15psCRACM_avg.csv', header = TRUE)
data <-rbind(Het, HO)
celldepth <- read.csv('cellid_depth.csv')
data <-merge(data, celldepth)
data_L2 <- subset(data,Layer=='L2')
data_L3 <-subset (data, Layer == 'L3')
data_L3_r1 = subset(data_L3, Row == 1)
data_L3_r1_het = subset(data_L3_r1, Genotype == "Het")
data_L3_r1_het = droplevels(data_L3_r1_het)
data_L3_r1_HO = subset(data_L3_r1, Genotype == "HO")
data_L3_r1_HO = droplevels(data_L3_r1_HO)
t.test(depth ~ Genotype, data_L3_r1)
a1 <- aov(MeanIPSC  ~ Genotype * Row, data_L3)
summary (a1)
TukeyHSD(a1)
data_L3$Row <- factor (data_L3$Row)
data_L3_r1_het = subset(data_L3_r1, Genotype == "Het")
data_L3_r1_het = droplevels(data_L3_r1_het)
data_L3_r1_HO = subset(data_L3_r1, Genotype == "HO")
data_L3_r1_HO = droplevels(data_L3_r1_HO)
t.test(depth ~ Genotype, data_L3_r1)
a1 <- aov(MeanIPSC  ~ Genotype * Row, data_L3)
summary (a1)
TukeyHSD(a1)
data_L3_het = subset(data_L3, Genotype == "Het")
data_L3_het = droplevels(data_L3_r1_het)
data_L3_HO = subset(data_L3, Genotype == "HO")
data_L3_HO = droplevels(data_L3_HO)
data_L3_het <- data_L3_het[order(data_L3_het$depth),]
library(reshape2)
library(gplots)
mhet<- acast(data_L3_het, Row~depth + cellid, value.var="MeanIPSC")
mhet_matrix <- data.matrix(mhet)
mKO<- acast(data_L3_HO, Row ~ depth + cellid, value.var="MeanIPSC")
mKO_matrix <- data.matrix(mKO)
tmatrix <-cbind(mhet, mKO)
colfunc1 <- colorRampPalette(c("white", "yellow", "orange", "red", "black" ))
hmcols <- c(colfunc1(500))
heatmap.2(tmatrix,margin=c(10,20), key = FALSE ,dendrogram="none",trace="none",scale="none", col=hmcols,
Rowv=FALSE, Colv=FALSE)
mKO_matrix <- data.matrix(mKO)
tmatrix <-cbind(mhet_matrix, mKO_matrix)
mKO<- acast(data_L3_HO, Row ~ depth + cellid, value.var="MeanIPSC")
mKO<- acast(data_L3_HO, Row~depth + cellid, value.var="MeanIPSC")
mhet<- acast(data_L3_het, Row~depth + cellid, value.var="MeanIPSC")
mhet_matrix <- data.matrix(mhet)
mKO <-tmartix(mKO)
mKO <-t(mKO)
mKO_matrix <- data.matrix(mKO)
data_L3_het = subset(data_L3, Genotype == "Het")
data_L3_het = droplevels(data_L3_het)
data_L3_HO = subset(data_L3, Genotype == "HO")
data_L3_HO = droplevels(data_L3_HO)
data_L3_het <- data_L3_het[order(data_L3_het$depth),]
data_L3_HO <- data_L3_HO[order(data_L3_HO$depth),]
library(reshape2)
library(gplots)
mhet<- acast(data_L3_het, Row~depth + cellid, value.var="MeanIPSC")
mhet_matrix <- data.matrix(mhet)
mKO<- acast(data_L3_HO, Row~depth + cellid, value.var="MeanIPSC")
mKO_matrix <- data.matrix(mKO)
library(gplots)
tmatrix <-cbind(mhet_matrix, mKO_matrix)
colfunc1 <- colorRampPalette(c("white", "yellow", "orange", "red", "black" ))
hmcols <- c(colfunc1(500))
heatmap.2(tmatrix,margin=c(10,20), key = FALSE ,dendrogram="none",trace="none",scale="none", col=hmcols,
Rowv=FALSE, Colv=FALSE)
heatmap.2(tmatrix,margin=c(10,20), key = FALSE ,dendrogram="none",trace="none",scale="none", col=hmcols,
Rowv=FALSE, Colv=FALSE)
legend(y=1.1, x=.25, xpd=TRUE,
legend = unique(dat$GO),
col = unique(as.numeric(dat$GO)),
lty= 1,
lwd = 5,
cex=.7
)
heatmap.2(tmatrix,margin=c(10,20), key = TRUE ,dendrogram="none",trace="none",scale="none", col=hmcols,
Rowv=FALSE, Colv=FALSE)
data_L3_r1_het = subset(data_L3_r1, Genotype == "Het")
data_L3_r1_het = droplevels(data_L3_r1_het)
data_L3_r1_HO = subset(data_L3_r1, Genotype == "HO")
data_L3_r1_HO = droplevels(data_L3_r1_HO)
t.test(depth ~ Genotype, data_L3_r1)
summary (a1)
q1 <- ddply(data_L3, .(Genotype, Row), summarise, q25 = quantile (MeanIPSC, 0.25), q50 = quantile (MeanIPSC, 0.5),
q75 = quantile (MeanIPSC, 0.75))
q1
setwd("~/Dropbox/Fishou/Marinlabwork/papers_writing/Migration routes (1)/NN/R1/Figures/Figure 6/data/2017-10 ephys analysis/Analysis_sCRACM/2017_R_ephys")
library (plotrix) #use for std.error
library (ggplot2) #use for ggplot
library (plyr) #use for ddply
Het <- read.csv('Het15psCRACM_avg.csv', header = TRUE)
HO <- read.csv('HO15psCRACM_avg.csv', header = TRUE)
data <-rbind(Het, HO)
celldepth <- read.csv('cellid_depth.csv')
data <-merge(data, celldepth)
data_L2 <- subset(data,Layer=='L2')
data_L3 <-subset (data, Layer == 'L3')
data_L3_r1 = subset(data_L3, Row == 1)
data_L3$Row <- factor (data_L3$Row)
data_L3_r1_het = subset(data_L3_r1, Genotype == "Het")
data_L3_r1_het = droplevels(data_L3_r1_het)
data_L3_r1_HO = subset(data_L3_r1, Genotype == "HO")
data_L3_r1_HO = droplevels(data_L3_r1_HO)
t.test(depth ~ Genotype, data_L3_r1)
a1 <- aov(MeanIPSC  ~ Genotype * Row, data_L3)
summary (a1)
library(reshape2)
library(gplots)
mhet<- acast(data_L3_het, Row~depth + cellid, value.var="MeanIPSC")
install.packages("gplots")
library(reshape2)
library(gplots)
mhet<- acast(data_L3_het, Row~depth + cellid, value.var="MeanIPSC")
data_L3_het = subset(data_L3, Genotype == "Het")
data_L3_het = droplevels(data_L3_het)
data_L3_HO = subset(data_L3, Genotype == "HO")
data_L3_HO = droplevels(data_L3_HO)
data_L3_het <- data_L3_het[order(data_L3_het$depth),]
data_L3_HO <- data_L3_HO[order(data_L3_HO$depth),]
library(reshape2)
library(gplots)
mhet<- acast(data_L3_het, Row~depth + cellid, value.var="MeanIPSC")
mhet_matrix <- data.matrix(mhet)
mKO<- acast(data_L3_HO, Row~depth + cellid, value.var="MeanIPSC")
mKO_matrix <- data.matrix(mKO)
tmatrix <-cbind(mhet_matrix, mKO_matrix)
colfunc1 <- colorRampPalette(c("white", "yellow", "orange", "red", "black" ))
hmcols <- c(colfunc1(500))
heatmap.2(tmatrix,margin=c(10,20), key = TRUE ,dendrogram="none",trace="none",scale="none", col=hmcols,
Rowv=FALSE, Colv=FALSE)
heatmap.2(tmatrix,margin=c(10,20), key = FALSE ,dendrogram="none",trace="none",scale="none", col=hmcols,
Rowv=FALSE, Colv=FALSE)
heatmap.2(tmatrix, key = FALSE ,dendrogram="none",trace="none",scale="none", col=hmcols,
Rowv=FALSE, Colv=FALSE)
